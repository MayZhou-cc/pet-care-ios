{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\s4397674\\\\Documents\\\\PP\\\\test\\\\components\\\\ShopScreen.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport Icon from \"@expo/vector-icons/Ionicons\";\nimport React, { Component, useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport { createAppContainer } from \"react-navigation\";\nimport { createMaterialTopTabNavigator } from \"react-navigation-tabs\";\nimport { fb } from \"../src/firebase/APIKeys\";\nimport images from \"../components/images\";\nvar baseCurrency = 500;\n\nfunction OwnedTab() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      read = _useState2[0],\n      allReads = _useState2[1];\n\n  useEffect(function () {\n    var readRef = fb.database().ref(\"/response/shop\");\n    var OnLoadingListener = readRef.on(\"value\", function (snapshot) {\n      allReads([]);\n      snapshot.forEach(function (childSnapshot) {\n        allReads(function (read) {\n          return [].concat(_toConsumableArray(read), [childSnapshot.val()]);\n        });\n      });\n    });\n    return function () {\n      readRef.off(\"value\", OnLoadingListener);\n    };\n  }, []);\n  return React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }\n  }, React.createElement(SafeAreaView, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, React.createElement(ScrollView, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, read.map(function (item, index) {\n    if (item[\"bought\"]) {\n      if (item[\"img\"] === 0) {\n        return React.createElement(View, {\n          key: item[\"img\"],\n          style: styles.itemContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 19\n          }\n        }, React.createElement(Image, {\n          style: styles.avatar,\n          source: images.character0,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: styles.text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 21\n          }\n        }, \"Price: \", item[\"price\"]), React.createElement(Button, {\n          title: \"Set\",\n          disabled: false,\n          onPress: function onPress() {\n            return setAvatar(item, index);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 21\n          }\n        }));\n      } else if (item[\"img\"] === 1) {\n        return React.createElement(View, {\n          key: item[\"img\"],\n          style: styles.itemContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 19\n          }\n        }, React.createElement(Image, {\n          style: styles.avatar,\n          source: images.character1,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: styles.text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 21\n          }\n        }, \"Price: \", item[\"price\"]), React.createElement(Button, {\n          title: \"Set\",\n          disabled: false,\n          onPress: function onPress() {\n            return setAvatar(item, index);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 21\n          }\n        }));\n      } else if (item[\"img\"] === 2) {\n        return React.createElement(View, {\n          key: item[\"img\"],\n          style: styles.itemContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 19\n          }\n        }, React.createElement(Image, {\n          style: styles.avatar,\n          source: images.character2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: styles.text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 21\n          }\n        }, \"Price: \", item[\"price\"]), React.createElement(Button, {\n          title: \"Set\",\n          disabled: false,\n          onPress: function onPress() {\n            return setAvatar(item, index);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 21\n          }\n        }));\n      } else if (item[\"img\"] === 3) {\n        return React.createElement(View, {\n          key: item[\"img\"],\n          style: styles.itemContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 19\n          }\n        }, React.createElement(Image, {\n          style: styles.avatar,\n          source: images.character3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: styles.text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 21\n          }\n        }, \"Price: \", item[\"price\"]), React.createElement(Button, {\n          title: \"Set\",\n          disabled: false,\n          onPress: function onPress() {\n            return setAvatar(item, index);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 21\n          }\n        }));\n      }\n    }\n  }))));\n}\n\nOwnedTab.navigationOptions = {\n  tabBarIcon: function tabBarIcon(_ref) {\n    var tintColor = _ref.tintColor,\n        focused = _ref.focused;\n    return React.createElement(Icon, {\n      name: focused ? \"ios-mail-open\" : \"md-mail-open\",\n      color: tintColor,\n      size: 25,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 5\n      }\n    });\n  }\n};\n\nvar recordBuying = function recordBuying(index, buy, imgUrl, itemPrice) {\n  return new Promise(function (resolve, reject) {\n    var data = {\n      bought: buy,\n      img: imgUrl,\n      price: itemPrice\n    };\n    fb.database().ref(\"/response/shop/\" + index).update(data).then(function (snapshot) {\n      resolve(snapshot);\n    }).catch(function (err) {\n      reject(err);\n    });\n  });\n};\n\nfunction completeBuying(price) {\n  baseCurrency = baseCurrency - price;\n  fb.database().ref(\"response/\").update({\n    currency: baseCurrency\n  }).then(function () {\n    console.log(\"Success buying\");\n  }).catch(function (error) {\n    console.log(error);\n  });\n}\n\nfunction confirmShopping(item, index) {\n  Alert.alert(\"Are you sure?\", \"Unlock this avatar with $\" + item[\"price\"], [{\n    text: \"Cancel\",\n    onPress: function onPress() {\n      return console.log(\"Cancel Pressed\");\n    },\n    style: \"cancel\"\n  }, {\n    text: \"OK\",\n    onPress: function onPress() {\n      completeBuying(item[\"price\"]);\n      recordBuying(index, !item[\"bought\"], item[\"img\"], item[\"price\"]);\n    }\n  }], {\n    cancelable: false\n  });\n}\n\nfunction setAvatar(item, index) {\n  Alert.alert(\"Are you sure?\", \"Raise this avatar on home page\", [{\n    text: \"Cancel\",\n    onPress: function onPress() {\n      return console.log(\"Cancel Pressed\");\n    },\n    style: \"cancel\"\n  }, {\n    text: \"OK\",\n    onPress: function onPress() {\n      console.log(\"hello olivia, you reached here\");\n      updataAvatar(index);\n    }\n  }], {\n    cancelable: false\n  });\n}\n\nfunction updataAvatar(data) {\n  console.log(\"print out the avatar index: \" + data);\n  fb.database().ref(\"response/\").update({\n    character: data\n  }).then(function () {\n    console.log(\"Success buying\");\n  }).catch(function (error) {\n    console.log(error);\n  });\n}\n\nfunction ShopTab() {\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      unbought = _useState4[0],\n      allUnbought = _useState4[1];\n\n  useEffect(function () {\n    var unboughtRef = fb.database().ref(\"/response/shop\");\n    var OnLoadingListener = unboughtRef.on(\"value\", function (snapshot) {\n      allUnbought([]);\n      snapshot.forEach(function (childSnapshot) {\n        allUnbought(function (unbought) {\n          return [].concat(_toConsumableArray(unbought), [childSnapshot.val()]);\n        });\n      });\n    });\n    return function () {\n      unboughtRef.off(\"value\", OnLoadingListener);\n    };\n  }, []);\n  return React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 5\n    }\n  }, React.createElement(SafeAreaView, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 7\n    }\n  }, React.createElement(ScrollView, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 9\n    }\n  }, unbought.map(function (item, index) {\n    if (!item[\"bought\"]) {\n      if (item[\"img\"] === 0) {\n        return React.createElement(View, {\n          key: item[\"img\"],\n          style: styles.itemContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 19\n          }\n        }, React.createElement(Image, {\n          style: styles.avatar,\n          source: images.character0,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: styles.text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 21\n          }\n        }, \"Price: \", item[\"price\"]), React.createElement(Button, {\n          title: \"buy\",\n          disabled: false,\n          onPress: function onPress() {\n            return confirmShopping(item, index);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 21\n          }\n        }));\n      } else if (item[\"img\"] === 1) {\n        return React.createElement(View, {\n          key: item[\"img\"],\n          style: styles.itemContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 19\n          }\n        }, React.createElement(Image, {\n          style: styles.avatar,\n          source: images.character1,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: styles.text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 21\n          }\n        }, \"Price: \", item[\"price\"]), React.createElement(Button, {\n          title: \"buy\",\n          disabled: false,\n          onPress: function onPress() {\n            return confirmShopping(item, index);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 21\n          }\n        }));\n      } else if (item[\"img\"] === 2) {\n        return React.createElement(View, {\n          key: item[\"img\"],\n          style: styles.itemContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 19\n          }\n        }, React.createElement(Image, {\n          style: styles.avatar,\n          source: images.character2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: styles.text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 21\n          }\n        }, \"Price: \", item[\"price\"]), React.createElement(Button, {\n          title: \"buy\",\n          disabled: false,\n          onPress: function onPress() {\n            return confirmShopping(item, index);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 21\n          }\n        }));\n      } else if (item[\"img\"] === 3) {\n        return React.createElement(View, {\n          key: item[\"img\"],\n          style: styles.itemContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 19\n          }\n        }, React.createElement(Image, {\n          style: styles.avatar,\n          source: images.character3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: styles.text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 21\n          }\n        }, \"Price: \", item[\"price\"]), React.createElement(Button, {\n          title: \"buy\",\n          disabled: false,\n          onPress: function onPress() {\n            return confirmShopping(item, index);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 21\n          }\n        }));\n      }\n    }\n  }))));\n}\n\nShopTab.navigationOptions = {\n  tabBarIcon: function tabBarIcon(_ref2) {\n    var tintColor = _ref2.tintColor,\n        focused = _ref2.focused;\n    return React.createElement(Icon, {\n      name: focused ? \"ios-mail-unread\" : \"md-mail-unread\",\n      color: tintColor,\n      size: 25,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 5\n      }\n    });\n  }\n};\nvar Tab = createMaterialTopTabNavigator({\n  Shop: ShopTab,\n  Owned: OwnedTab\n}, {\n  tabBarOptions: {\n    activeTintColor: \"black\",\n    showIcon: true,\n    showLabel: true,\n    style: {\n      backgroundColor: \"#FF9933\"\n    }\n  }\n});\nvar AppIndex = createAppContainer(Tab);\n\nvar HomeScreen = function (_Component) {\n  _inherits(HomeScreen, _Component);\n\n  var _super = _createSuper(HomeScreen);\n\n  function HomeScreen(props) {\n    var _this;\n\n    _classCallCheck(this, HomeScreen);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      avatarCurrency: 0,\n      items: {}\n    };\n    return _this;\n  }\n\n  _createClass(HomeScreen, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      fb.database().ref(\"response/shop\").on(\"value\", function (querySnapShot) {\n        var data = querySnapShot.val() ? querySnapShot.val() : {};\n\n        var shopitems = _objectSpread({}, data);\n\n        console.log(data);\n\n        _this2.setState({\n          items: shopitems\n        });\n      });\n      fb.database().ref(\"response/currency\").on(\"value\", function (querySnapShot) {\n        var data = querySnapShot.val() ? querySnapShot.val() : {};\n        console.log(data);\n\n        _this2.setState({\n          avatarCurrency: data\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var itemKeys = Object.keys(this.state.items);\n      return React.createElement(View, {\n        style: styles.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 7\n        }\n      }, React.createElement(ImageBackground, {\n        source: require(\"../assets/BackgroundOrange.png\"),\n        style: styles.backgroundImage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 9\n        }\n      }, React.createElement(View, {\n        style: styles.avatarContainer,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 11\n        }\n      }, React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 13\n        }\n      }, \"Your currency: \", this.state.avatarCurrency)), React.createElement(AppIndex, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 11\n        }\n      })));\n    }\n  }]);\n\n  return HomeScreen;\n}(Component);\n\nexport { HomeScreen as default };\n\nvar ShopItem = function ShopItem(_ref3) {\n  var _ref3$shopItem = _ref3.shopItem,\n      itemprice = _ref3$shopItem.price,\n      done = _ref3$shopItem.done,\n      id = _ref3.id;\n\n  var _useState5 = useState(done),\n      _useState6 = _slicedToArray(_useState5, 2),\n      doneState = _useState6[0],\n      setDone = _useState6[1];\n\n  var onCheck = function onCheck() {\n    setDone(!doneState);\n    fb.database().ref(\"response/shop\").update(_defineProperty({}, id, {\n      price: itemprice,\n      bought: !doneState\n    }));\n    Alert.alert(\"Congrats, a new character unlocked!\");\n  };\n\n  return React.createElement(View, {\n    style: styles.itemContainer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 5\n    }\n  }, React.createElement(Image, {\n    style: styles.avatar,\n    source: require(\"../assets/avatar/character3.png\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 7\n    }\n  }), React.createElement(Button, {\n    title: \"buy\",\n    onPress: onCheck,\n    disabled: doneState,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 7\n    }\n  }), React.createElement(Text, {\n    style: [styles.buyText, {\n      opacity: doneState ? 0.2 : 1\n    }],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 7\n    }\n  }, \"Price: \", itemprice));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    backgroundColor: \"#f0f8ff\",\n    flex: 1,\n    flexDirection: \"column\"\n  },\n  backgroundImage: {\n    flex: 1,\n    resizeMode: \"cover\",\n    justifyContent: \"center\"\n  },\n  itemContainer: {\n    height: 230,\n    borderWidth: 0.5,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    margin: 3\n  },\n  avatarContainer: {\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  avatar: {\n    width: \"30%\",\n    height: \"50%\",\n    alignItems: \"center\"\n  },\n  buyText: {\n    textAlign: \"center\"\n  }\n});","map":{"version":3,"sources":["C:/Users/s4397674/Documents/PP/test/components/ShopScreen.js"],"names":["Icon","React","Component","useState","useEffect","createAppContainer","createMaterialTopTabNavigator","fb","images","baseCurrency","OwnedTab","read","allReads","readRef","database","ref","OnLoadingListener","on","snapshot","forEach","childSnapshot","val","off","map","item","index","styles","itemContainer","avatar","character0","text","setAvatar","character1","character2","character3","navigationOptions","tabBarIcon","tintColor","focused","recordBuying","buy","imgUrl","itemPrice","Promise","resolve","reject","data","bought","img","price","update","then","catch","err","completeBuying","currency","console","log","error","confirmShopping","Alert","alert","onPress","style","cancelable","updataAvatar","character","ShopTab","unbought","allUnbought","unboughtRef","Tab","Shop","Owned","tabBarOptions","activeTintColor","showIcon","showLabel","backgroundColor","AppIndex","HomeScreen","props","state","avatarCurrency","items","querySnapShot","shopitems","setState","itemKeys","Object","keys","container","require","backgroundImage","avatarContainer","ShopItem","shopItem","itemprice","done","id","doneState","setDone","onCheck","buyText","opacity","StyleSheet","create","flex","flexDirection","resizeMode","justifyContent","height","borderWidth","alignItems","margin","width","textAlign"],"mappings":"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","sourcesContent":["// Homescreen.js\r\n\r\nimport Icon from \"react-native-vector-icons/Ionicons\";\r\nimport React, { Component, useState, useEffect } from \"react\";\r\nimport {\r\n  StyleSheet,\r\n  Text,\r\n  View,\r\n  TouchableOpacity,\r\n  ImageBackground,\r\n  SafeAreaView,\r\n  ScrollView,\r\n  Alert,\r\n  Image,\r\n  Button,\r\n} from \"react-native\";\r\nimport { createAppContainer } from \"react-navigation\";\r\nimport { createMaterialTopTabNavigator } from \"react-navigation-tabs\";\r\nimport { fb } from \"../src/firebase/APIKeys\";\r\nimport images from \"../components/images\";\r\n\r\nvar baseCurrency = 500;\r\n\r\n// function displayChracter(data) {\r\n//   if (data === 0) {\r\n//     console.log(\"000000 test reach here\");\r\n//     return images.character0;\r\n//     // <View key={0} style={styles.itemContainer}>\r\n//     //   <Text>Text msg - 000 </Text>\r\n//     //   <Image style={styles.avatar} source={images.character0} />\r\n//     //   {/* <Text style={styles.text}>Price: {item[\"price\"]}</Text> */}\r\n//     //   <Button title=\"buy\" disabled={true} />\r\n//     // </View>\r\n//   } else if (data === 1) {\r\n//     console.log(\"********test reach here\");\r\n//     return (\r\n//       <View key={1} style={styles.itemContainer}>\r\n//         <Text>Text msg - 111</Text>\r\n//         <Image style={styles.avatar} source={images.character1} />\r\n//         <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n//         <Button title=\"buy\" disabled={true} />\r\n//       </View>\r\n//     );\r\n//   } else if (data === 2) {\r\n//     return (\r\n//       <View key={2} style={styles.itemContainer}>\r\n//         <Image style={styles.avatar} source={images.character2} />\r\n//         <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n//         <Button title=\"buy\" disabled={true} />\r\n//       </View>\r\n//     );\r\n//   } else if (data === 3) {\r\n//     return (\r\n//       <View key={3} style={styles.itemContainer}>\r\n//         <Image style={styles.avatar} source={images.character3} />\r\n//         <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n//         <Button title=\"buy\" disabled={true} />\r\n//       </View>\r\n//     );\r\n//   }\r\n// }\r\n\r\nfunction OwnedTab() {\r\n  const [read, allReads] = useState([]);\r\n  useEffect(() => {\r\n    const readRef = fb.database().ref(\"/response/shop\");\r\n    const OnLoadingListener = readRef.on(\"value\", (snapshot) => {\r\n      allReads([]);\r\n      snapshot.forEach(function (childSnapshot) {\r\n        allReads((read) => [...read, childSnapshot.val()]);\r\n      });\r\n    });\r\n\r\n    return () => {\r\n      readRef.off(\"value\", OnLoadingListener);\r\n    };\r\n  }, []);\r\n  return (\r\n    <View>\r\n      <SafeAreaView>\r\n        <ScrollView>\r\n          {read.map(function (item, index) {\r\n            if (item[\"bought\"]) {\r\n              if (item[\"img\"] === 0) {\r\n                return (\r\n                  <View key={item[\"img\"]} style={styles.itemContainer}>\r\n                    <Image style={styles.avatar} source={images.character0} />\r\n                    <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n                    <Button\r\n                      title=\"Set\"\r\n                      disabled={false}\r\n                      onPress={() => setAvatar(item, index)}\r\n                    />\r\n                  </View>\r\n                );\r\n              } else if (item[\"img\"] === 1) {\r\n                return (\r\n                  <View key={item[\"img\"]} style={styles.itemContainer}>\r\n                    <Image style={styles.avatar} source={images.character1} />\r\n                    <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n                    <Button\r\n                      title=\"Set\"\r\n                      disabled={false}\r\n                      onPress={() => setAvatar(item, index)}\r\n                    />\r\n                  </View>\r\n                );\r\n              } else if (item[\"img\"] === 2) {\r\n                return (\r\n                  <View key={item[\"img\"]} style={styles.itemContainer}>\r\n                    <Image style={styles.avatar} source={images.character2} />\r\n                    <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n                    <Button\r\n                      title=\"Set\"\r\n                      disabled={false}\r\n                      onPress={() => setAvatar(item, index)}\r\n                    />\r\n                  </View>\r\n                );\r\n              } else if (item[\"img\"] === 3) {\r\n                return (\r\n                  <View key={item[\"img\"]} style={styles.itemContainer}>\r\n                    <Image style={styles.avatar} source={images.character3} />\r\n                    <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n                    <Button\r\n                      title=\"Set\"\r\n                      disabled={false}\r\n                      onPress={() => setAvatar(item, index)}\r\n                    />\r\n                  </View>\r\n                );\r\n              }\r\n            }\r\n          })}\r\n        </ScrollView>\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n}\r\nOwnedTab.navigationOptions = {\r\n  tabBarIcon: ({ tintColor, focused }) => (\r\n    <Icon\r\n      name={focused ? \"ios-mail-open\" : \"md-mail-open\"}\r\n      color={tintColor}\r\n      size={25}\r\n    />\r\n  ),\r\n};\r\n\r\nconst recordBuying = (index, buy, imgUrl, itemPrice) => {\r\n  return new Promise(function (resolve, reject) {\r\n    let data = {\r\n      bought: buy,\r\n      img: imgUrl,\r\n      price: itemPrice,\r\n    };\r\n    fb.database()\r\n      .ref(\"/response/shop/\" + index)\r\n      .update(data)\r\n      .then((snapshot) => {\r\n        resolve(snapshot);\r\n      })\r\n      .catch((err) => {\r\n        reject(err);\r\n      });\r\n  });\r\n};\r\n\r\nfunction completeBuying(price) {\r\n  baseCurrency = baseCurrency - price;\r\n  fb.database()\r\n    .ref(\"response/\")\r\n    .update({\r\n      currency: baseCurrency,\r\n    })\r\n    .then(() => {\r\n      console.log(\"Success buying\");\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n}\r\n\r\nfunction confirmShopping(item, index) {\r\n  Alert.alert(\r\n    \"Are you sure?\",\r\n    \"Unlock this avatar with $\" + item[\"price\"],\r\n    [\r\n      {\r\n        text: \"Cancel\",\r\n        onPress: () => console.log(\"Cancel Pressed\"),\r\n        style: \"cancel\",\r\n      },\r\n      {\r\n        text: \"OK\",\r\n        onPress: () => {\r\n          completeBuying(item[\"price\"]);\r\n          recordBuying(index, !item[\"bought\"], item[\"img\"], item[\"price\"]);\r\n        },\r\n      },\r\n    ],\r\n    { cancelable: false }\r\n  );\r\n}\r\n\r\nfunction setAvatar(item, index) {\r\n  Alert.alert(\r\n    \"Are you sure?\",\r\n    \"Raise this avatar on home page\",\r\n    [\r\n      {\r\n        text: \"Cancel\",\r\n        onPress: () => console.log(\"Cancel Pressed\"),\r\n        style: \"cancel\",\r\n      },\r\n      {\r\n        text: \"OK\",\r\n        onPress: () => {\r\n          console.log(\"hello olivia, you reached here\");\r\n          updataAvatar(index);\r\n          // completeBuying(index);\r\n        },\r\n      },\r\n    ],\r\n    { cancelable: false }\r\n  );\r\n}\r\n\r\nfunction updataAvatar(data) {\r\n  console.log(\"print out the avatar index: \" + data);\r\n  fb.database()\r\n    .ref(\"response/\")\r\n    .update({\r\n      character: data,\r\n    })\r\n    .then(() => {\r\n      console.log(\"Success buying\");\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n}\r\n\r\nfunction ShopTab() {\r\n  const [unbought, allUnbought] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const unboughtRef = fb.database().ref(\"/response/shop\");\r\n    const OnLoadingListener = unboughtRef.on(\"value\", (snapshot) => {\r\n      allUnbought([]);\r\n      snapshot.forEach(function (childSnapshot) {\r\n        // console.log(childSnapshot.val());\r\n        allUnbought((unbought) => [...unbought, childSnapshot.val()]);\r\n      });\r\n    });\r\n\r\n    return () => {\r\n      unboughtRef.off(\"value\", OnLoadingListener);\r\n    };\r\n  }, []);\r\n  return (\r\n    <View>\r\n      <SafeAreaView>\r\n        <ScrollView>\r\n          {unbought.map(function (item, index) {\r\n            if (!item[\"bought\"]) {\r\n              if (item[\"img\"] === 0) {\r\n                return (\r\n                  <View key={item[\"img\"]} style={styles.itemContainer}>\r\n                    <Image style={styles.avatar} source={images.character0} />\r\n                    <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n                    <Button\r\n                      title=\"buy\"\r\n                      disabled={false}\r\n                      onPress={() => confirmShopping(item, index)}\r\n                    />\r\n                  </View>\r\n                );\r\n              } else if (item[\"img\"] === 1) {\r\n                return (\r\n                  <View key={item[\"img\"]} style={styles.itemContainer}>\r\n                    <Image style={styles.avatar} source={images.character1} />\r\n                    <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n                    <Button\r\n                      title=\"buy\"\r\n                      disabled={false}\r\n                      onPress={() => confirmShopping(item, index)}\r\n                    />\r\n                  </View>\r\n                );\r\n              } else if (item[\"img\"] === 2) {\r\n                return (\r\n                  <View key={item[\"img\"]} style={styles.itemContainer}>\r\n                    <Image style={styles.avatar} source={images.character2} />\r\n                    <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n                    <Button\r\n                      title=\"buy\"\r\n                      disabled={false}\r\n                      onPress={() => confirmShopping(item, index)}\r\n                    />\r\n                  </View>\r\n                );\r\n              } else if (item[\"img\"] === 3) {\r\n                return (\r\n                  <View key={item[\"img\"]} style={styles.itemContainer}>\r\n                    <Image style={styles.avatar} source={images.character3} />\r\n                    <Text style={styles.text}>Price: {item[\"price\"]}</Text>\r\n                    <Button\r\n                      title=\"buy\"\r\n                      disabled={false}\r\n                      onPress={() => confirmShopping(item, index)}\r\n                    />\r\n                  </View>\r\n                );\r\n              }\r\n            }\r\n          })}\r\n        </ScrollView>\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n}\r\nShopTab.navigationOptions = {\r\n  tabBarIcon: ({ tintColor, focused }) => (\r\n    <Icon\r\n      name={focused ? \"ios-mail-unread\" : \"md-mail-unread\"}\r\n      color={tintColor}\r\n      size={25}\r\n    />\r\n  ),\r\n};\r\n\r\nconst Tab = createMaterialTopTabNavigator(\r\n  {\r\n    Shop: ShopTab,\r\n    Owned: OwnedTab,\r\n  },\r\n  {\r\n    tabBarOptions: {\r\n      activeTintColor: \"black\",\r\n      showIcon: true,\r\n      showLabel: true,\r\n      style: {\r\n        backgroundColor: \"#FF9933\",\r\n      },\r\n    },\r\n  }\r\n);\r\nconst AppIndex = createAppContainer(Tab);\r\n\r\nexport default class HomeScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      avatarCurrency: 0,\r\n      items: {},\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    fb.database()\r\n      .ref(\"response/shop\")\r\n      .on(\"value\", (querySnapShot) => {\r\n        let data = querySnapShot.val() ? querySnapShot.val() : {};\r\n        let shopitems = { ...data };\r\n        console.log(data);\r\n        this.setState({\r\n          items: shopitems,\r\n        });\r\n      });\r\n    fb.database()\r\n      .ref(\"response/currency\")\r\n      .on(\"value\", (querySnapShot) => {\r\n        let data = querySnapShot.val() ? querySnapShot.val() : {};\r\n        console.log(data);\r\n        this.setState({\r\n          avatarCurrency: data,\r\n        });\r\n      });\r\n  }\r\n\r\n  render() {\r\n    let itemKeys = Object.keys(this.state.items);\r\n\r\n    return (\r\n      <View style={styles.container}>\r\n        <ImageBackground\r\n          source={require(\"../assets/BackgroundOrange.png\")}\r\n          style={styles.backgroundImage}\r\n        >\r\n          <View style={styles.avatarContainer}>\r\n            <Text>Your currency: {this.state.avatarCurrency}</Text>\r\n          </View>\r\n          <AppIndex />\r\n        </ImageBackground>\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst ShopItem = ({ shopItem: { price: itemprice, done }, id }) => {\r\n  const [doneState, setDone] = useState(done);\r\n\r\n  const onCheck = () => {\r\n    setDone(!doneState);\r\n    fb.database()\r\n      .ref(\"response/shop\")\r\n      .update({\r\n        [id]: {\r\n          price: itemprice,\r\n          bought: !doneState,\r\n        },\r\n      });\r\n    Alert.alert(\"Congrats, a new character unlocked!\");\r\n  };\r\n\r\n  // style check box after clicking\r\n  return (\r\n    <View style={styles.itemContainer}>\r\n      <Image\r\n        style={styles.avatar}\r\n        source={require(\"../assets/avatar/character3.png\")}\r\n      />\r\n\r\n      <Button title=\"buy\" onPress={onCheck} disabled={doneState} />\r\n      <Text style={[styles.buyText, { opacity: doneState ? 0.2 : 1 }]}>\r\n        Price: {itemprice}\r\n      </Text>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    backgroundColor: \"#f0f8ff\",\r\n    flex: 1,\r\n    flexDirection: \"column\",\r\n  },\r\n\r\n  backgroundImage: {\r\n    flex: 1,\r\n    resizeMode: \"cover\",\r\n    justifyContent: \"center\",\r\n  },\r\n\r\n  itemContainer: {\r\n    height: 230,\r\n    borderWidth: 0.5,\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    margin: 3,\r\n  },\r\n\r\n  avatarContainer: {\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n  },\r\n\r\n  avatar: {\r\n    width: \"30%\",\r\n    height: \"50%\",\r\n    alignItems: \"center\",\r\n  },\r\n\r\n  buyText: {\r\n    textAlign: \"center\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}