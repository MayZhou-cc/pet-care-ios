{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\s4397674\\\\Documents\\\\PP\\\\test\\\\components\\\\QuestScreen.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component, useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport Icon from \"@expo/vector-icons/Ionicons\";\nimport { createAppContainer } from \"react-navigation\";\nimport { createMaterialTopTabNavigator } from \"react-navigation-tabs\";\nimport { fb, Fire } from \"../src/firebase/APIKeys.js\";\nimport * as firebase from \"firebase\";\nimport { getBackgroundImage } from \"../components/images\";\nimport Header from \"../components/Header\";\nvar baseHealth = 0;\nvar baseStatus = 0;\nvar baseCurrency = 0;\nvar userid = Fire.shared.user._id;\nconsole.log(\"questScreen userID \" + userid);\n\n(function () {\n  return readData();\n});\n\nfunction readData() {\n  userid = Fire.shared.user._id;\n  console.log(\"reading data userID \" + userid);\n  firebase.database().ref(\"response/\" + userid + \"/avatarHealth\").once(\"value\", function (dataSnapShot) {\n    baseHealth = dataSnapShot.val();\n  });\n  firebase.database().ref(\"response/\" + userid + \"/avatarStatus\").once(\"value\", function (dataSnapShot) {\n    baseStatus = dataSnapShot.val();\n  });\n  firebase.database().ref(\"response/\" + userid + \"/currency\").once(\"value\", function (dataSnapShot) {\n    baseCurrency = dataSnapShot.val();\n  });\n  return baseHealth, baseStatus, baseCurrency;\n}\n\nfunction completeQuest(rewardHealth) {\n  baseHealth += rewardHealth[\"avatarHealth\"];\n  baseStatus += rewardHealth[\"avatarStatus\"];\n  baseCurrency += rewardHealth[\"shopCurrency\"];\n\n  if (baseHealth >= 100) {\n    fb.database().ref(\"response/\" + userid + \"/\").update({\n      avatarHealth: 100,\n      avatarStatus: baseStatus,\n      currency: baseCurrency\n    }).then(function () {\n      console.log(\"Completed a quest\");\n    }).catch(function (error) {\n      console.log(error);\n    });\n  } else {\n    fb.database().ref(\"response/\" + userid + \"/\").update({\n      avatarHealth: baseHealth,\n      avatarStatus: baseStatus,\n      currency: baseCurrency\n    }).then(function () {\n      console.log(\"Completed a quest\");\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n}\n\nvar updating = function updating(id, progress) {\n  return new Promise(function (resolve, reject) {\n    var key;\n\n    if (id != null) {\n      key = id;\n    } else {\n      key = fb.database().ref().push().key;\n    }\n\n    var complete = {\n      questCompletion: progress[\"questMaxValue\"],\n      questMaxValue: progress[\"questMaxValue\"]\n    };\n    var dataToSave = {\n      questID: key,\n      questProgress: complete\n    };\n    console.log(dataToSave);\n    fb.database().ref(\"/response/\" + userid + \"/quests/\" + key).update(dataToSave).then(function (snapshot) {\n      resolve(snapshot);\n    }).catch(function (err) {\n      reject(err);\n    });\n  });\n};\n\nfunction ReadAllTab() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      quests = _useState2[0],\n      allQuests = _useState2[1];\n\n  useEffect(function () {\n    var questRef = firebase.database().ref(\"/response/\" + userid + \"/quests/\");\n    var OnLoadingListener = questRef.on(\"value\", function (snapshot) {\n      allQuests([]);\n      snapshot.forEach(function (childSnapshot) {\n        allQuests(function (quests) {\n          return [].concat(_toConsumableArray(quests), [childSnapshot.val()]);\n        });\n      });\n    });\n    return function () {\n      questRef.off(\"value\", OnLoadingListener);\n    };\n  }, []);\n  return React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 5\n    }\n  }, quests.map(function (item) {\n    return React.createElement(TouchableOpacity, {\n      key: item[\"questID\"],\n      style: styles.textContainer,\n      onPress: function onPress() {\n        return Alert.alert(\"Task Complete?\", \"Confirm and get rewards:  \\nHealth: \" + item[\"questReward\"][\"avatarHealth\"] + \"\\nHappiness: \" + item[\"questReward\"][\"avatarStatus\"], [{\n          text: \"Cancel\",\n          onPress: function onPress() {\n            return console.log(\"click cancel\");\n          },\n          style: \"cancel\"\n        }, {\n          text: \"OK\",\n          onPress: function onPress() {\n            return completeQuest(item[\"questReward\"]);\n          }\n        }], {\n          cancelable: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }\n    }, React.createElement(View, {\n      style: styles.taskDiv,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: styles.taskTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 15\n      }\n    }, \" \", item[\"questName\"]), React.createElement(Text, {\n      style: styles.rewardPoint,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 15\n      }\n    }, \"+ \", item[\"questReward\"][\"avatarHealth\"], React.createElement(Icon, {\n      name: \"md-heart\",\n      color: \"red\",\n      size: 20,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }\n    }))), React.createElement(Text, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 13\n      }\n    }, \" \", item[\"questDescription\"]));\n  }));\n}\n\nReadAllTab.navigationOptions = {\n  tabBarIcon: function tabBarIcon(_ref) {\n    var tintColor = _ref.tintColor,\n        focused = _ref.focused;\n    return React.createElement(Icon, {\n      name: focused ? \"ios-cube\" : \"md-cube\",\n      color: tintColor,\n      size: 25,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 5\n      }\n    });\n  }\n};\n\nfunction InProgreeTab() {\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      inProgress = _useState4[0],\n      allInProgressQuests = _useState4[1];\n\n  useEffect(function () {\n    var questRef = firebase.database().ref(\"/response/\" + userid + \"/quests/\");\n    var OnLoadingListener = questRef.on(\"value\", function (snapshot) {\n      allInProgressQuests([]);\n      snapshot.forEach(function (childSnapshot) {\n        allInProgressQuests(function (inProgress) {\n          return [].concat(_toConsumableArray(inProgress), [childSnapshot.val()]);\n        });\n      });\n    });\n    return function () {\n      questRef.off(\"value\", OnLoadingListener);\n    };\n  }, []);\n  return React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 5\n    }\n  }, inProgress.map(function (item) {\n    if (item[\"questProgress\"][\"questCompletion\"] >= 0 && item[\"questProgress\"][\"questCompletion\"] != item[\"questProgress\"][\"questMaxValue\"]) {\n      return React.createElement(TouchableOpacity, {\n        key: item[\"questID\"],\n        style: styles.textContainer,\n        onPress: function onPress() {\n          return Alert.alert(\"Your Progress\", \"You have finished \" + item[\"questReward\"][\"avatarHealth\"] + \"/\" + item[\"questReward\"][\"avatarStatus\"] + \" of the task, good job and go on\", [{\n            text: \"Cancel\",\n            onPress: function onPress() {\n              return console.log(\"click cancel\");\n            },\n            style: \"cancel\"\n          }, {\n            text: \"OK\",\n            onPress: function onPress() {\n              completeQuest(item[\"questReward\"]);\n              updating(item[\"questID\"], item[\"questProgress\"]);\n            }\n          }], {\n            cancelable: false\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: styles.taskDiv,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 15\n        }\n      }, React.createElement(Text, {\n        style: styles.taskTitle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 17\n        }\n      }, \" \", item[\"questName\"]), React.createElement(Text, {\n        style: styles.rewardPoint,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 17\n        }\n      }, \"+ \", item[\"questReward\"][\"avatarHealth\"], React.createElement(Icon, {\n        name: \"md-heart\",\n        color: \"red\",\n        size: 20,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 19\n        }\n      }))), React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 15\n        }\n      }, \" \", item[\"questDescription\"]));\n    }\n  }));\n}\n\nInProgreeTab.navigationOptions = {\n  tabBarIcon: function tabBarIcon(_ref2) {\n    var tintColor = _ref2.tintColor,\n        focused = _ref2.focused;\n    return React.createElement(Icon, {\n      name: focused ? \"ios-stats\" : \"ios-stats\",\n      color: tintColor,\n      size: 25,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 5\n      }\n    });\n  }\n};\n\nfunction CompletionTab() {\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      completedQuest = _useState6[0],\n      allCompletedQuests = _useState6[1];\n\n  useEffect(function () {\n    var questRef = firebase.database().ref(\"/response/\" + userid + \"/quests/\");\n    var OnLoadingListener = questRef.on(\"value\", function (snapshot) {\n      allCompletedQuests([]);\n      snapshot.forEach(function (childSnapshot) {\n        allCompletedQuests(function (completedQuest) {\n          return [].concat(_toConsumableArray(completedQuest), [childSnapshot.val()]);\n        });\n      });\n    });\n    return function () {\n      questRef.off(\"value\", OnLoadingListener);\n    };\n  }, []);\n  return React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 5\n    }\n  }, completedQuest.map(function (item) {\n    if (item[\"questProgress\"][\"questCompletion\"] == item[\"questProgress\"][\"questMaxValue\"]) {\n      {\n        return React.createElement(TouchableOpacity, {\n          key: item[\"questID\"],\n          style: styles.textContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 15\n          }\n        }, React.createElement(View, {\n          style: styles.taskDiv,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 17\n          }\n        }, React.createElement(Text, {\n          style: styles.taskTitle,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 19\n          }\n        }, \" \", item[\"questName\"]), React.createElement(Text, {\n          style: styles.rewardPoint,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 19\n          }\n        }, \"+ \", item[\"questReward\"][\"avatarHealth\"], React.createElement(Icon, {\n          name: \"md-checkmark\",\n          color: \"green\",\n          size: 20,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 21\n          }\n        }))), React.createElement(Text, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 17\n          }\n        }, \" \", item[\"questDescription\"]));\n      }\n    }\n  }));\n}\n\nCompletionTab.navigationOptions = {\n  tabBarIcon: function tabBarIcon(_ref3) {\n    var tintColor = _ref3.tintColor,\n        focused = _ref3.focused;\n    return React.createElement(Icon, {\n      name: focused ? \"ios-flag\" : \"ios-flag\",\n      color: tintColor,\n      size: 25,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 5\n      }\n    });\n  }\n};\nvar Tab = createMaterialTopTabNavigator({\n  All: ReadAllTab,\n  Inprogress: InProgreeTab,\n  Completed: CompletionTab\n}, {\n  tabBarOptions: {\n    activeTintColor: \"black\",\n    showIcon: true,\n    showLabel: true,\n    style: {\n      borderColor: \"black\",\n      backgroundColor: \"transparent\"\n    }\n  }\n});\nvar AppIndex = createAppContainer(Tab);\n\nvar QuestScreen = function (_Component) {\n  _inherits(QuestScreen, _Component);\n\n  var _super = _createSuper(QuestScreen);\n\n  function QuestScreen(props) {\n    var _this;\n\n    _classCallCheck(this, QuestScreen);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      questCompletion: 0,\n      avatarStatus: 0,\n      avatarHealth: 0,\n      baseCurrency: 0,\n      backgroundColor: 5\n    };\n\n    if (!firebase.apps.length) {\n      firebase.initializeApp(ApiKeys.FirebaseConfig);\n    }\n\n    readData();\n\n    _this.readData();\n\n    return _this;\n  }\n\n  _createClass(QuestScreen, [{\n    key: \"readData\",\n    value: function readData() {\n      var _this2 = this;\n\n      userid = Fire.shared.user._id;\n      fb.database().ref(\"response/\" + userid + \"/backgroundColor\").once(\"value\", function (dataSnapShot) {\n        var tempColor = dataSnapShot.val();\n\n        _this2.setState({\n          backgroundColor: tempColor\n        });\n      });\n      fb.database().ref(\"response/\" + userid + \"/currency\").once(\"value\", function (dataSnapShot) {\n        var temp = dataSnapShot.val();\n\n        _this2.setState({\n          baseCurrency: temp\n        });\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      baseHealth, baseStatus, baseCurrency = readData();\n      this.setState({\n        baseHealth: baseHealth,\n        baseStatus: baseStatus,\n        baseCurrency: baseCurrency\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var background = getBackgroundImage(this.state.backgroundColor);\n      return React.createElement(View, {\n        style: styles.MainContainer,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 7\n        }\n      }, React.createElement(ImageBackground, {\n        source: background,\n        style: styles.backgroundImage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 9\n        }\n      }, React.createElement(Header, {\n        props: this.props,\n        pageName: \"Quests\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 11\n        }\n      }), React.createElement(AppIndex, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }\n      })));\n    }\n  }]);\n\n  return QuestScreen;\n}(Component);\n\nexport { QuestScreen as default };\nvar styles = StyleSheet.create({\n  backgroundImage: {\n    flex: 1,\n    resizeMode: \"cover\",\n    justifyContent: \"center\"\n  },\n  MainContainer: {\n    flex: 1,\n    flexDirection: \"column\"\n  },\n  navBar: {\n    flexDirection: \"row\",\n    justifyContent: \"space-evenly\"\n  },\n  taskCard: {\n    flex: 5,\n    backgroundColor: \"#fff\",\n    borderColor: \"black\",\n    borderWidth: 1,\n    margin: 10,\n    justifyContent: \"center\"\n  },\n  taskDiv: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\"\n  },\n  taskTitle: {\n    fontSize: 20\n  },\n  rewardPoint: {\n    fontSize: 20,\n    color: \"darkblue\"\n  },\n  taskbody: {\n    flex: 1,\n    fontSize: 14\n  },\n  taskDone: {\n    borderColor: \"#737373\",\n    backgroundColor: \"darkgrey\"\n  },\n  Content: {\n    flex: 10,\n    backgroundColor: \"#fff\",\n    marginTop: \"15%\"\n  },\n  textContainer: {\n    padding: 10,\n    marginTop: 3,\n    backgroundColor: \"white\",\n    borderColor: \"darkgrey\",\n    borderWidth: 1\n  }\n});","map":{"version":3,"sources":["C:/Users/s4397674/Documents/PP/test/components/QuestScreen.js"],"names":["React","Component","useState","useEffect","Icon","createAppContainer","createMaterialTopTabNavigator","fb","Fire","firebase","getBackgroundImage","Header","baseHealth","baseStatus","baseCurrency","userid","shared","user","_id","console","log","readData","database","ref","once","dataSnapShot","val","completeQuest","rewardHealth","update","avatarHealth","avatarStatus","currency","then","catch","error","updating","id","progress","Promise","resolve","reject","key","push","complete","questCompletion","questMaxValue","dataToSave","questID","questProgress","snapshot","err","ReadAllTab","quests","allQuests","questRef","OnLoadingListener","on","forEach","childSnapshot","off","map","item","styles","textContainer","Alert","alert","text","onPress","style","cancelable","taskDiv","taskTitle","rewardPoint","navigationOptions","tabBarIcon","tintColor","focused","InProgreeTab","inProgress","allInProgressQuests","CompletionTab","completedQuest","allCompletedQuests","Tab","All","Inprogress","Completed","tabBarOptions","activeTintColor","showIcon","showLabel","borderColor","backgroundColor","AppIndex","QuestScreen","props","state","apps","length","initializeApp","ApiKeys","FirebaseConfig","tempColor","setState","temp","background","MainContainer","backgroundImage","StyleSheet","create","flex","resizeMode","justifyContent","flexDirection","navBar","taskCard","borderWidth","margin","fontSize","color","taskbody","taskDone","Content","marginTop","padding"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from \"react\";\r\nimport {\r\n  StyleSheet,\r\n  Button,\r\n  View,\r\n  Text,\r\n  TouchableOpacity,\r\n  Image,\r\n  Alert,\r\n  ImageBackground,\r\n} from \"react-native\";\r\nimport Icon from \"react-native-vector-icons/Ionicons\";\r\nimport { createAppContainer } from \"react-navigation\";\r\nimport { createMaterialTopTabNavigator } from \"react-navigation-tabs\";\r\nimport { fb, Fire } from \"../src/firebase/APIKeys.js\";\r\nimport * as firebase from \"firebase\";\r\nimport { getBackgroundImage } from \"../components/images\";\r\nimport Header from \"../components/Header\";\r\n\r\nvar baseHealth = 0;\r\nvar baseStatus = 0;\r\nvar baseCurrency = 0;\r\nvar userid = Fire.shared.user._id;\r\nconsole.log(\"questScreen userID \" + userid);\r\n\r\n() => readData();\r\n\r\nfunction readData() {\r\n  userid = Fire.shared.user._id;\r\n  console.log(\"reading data userID \" + userid);\r\n  firebase\r\n    .database()\r\n    .ref(\"response/\" + userid + \"/avatarHealth\")\r\n    .once(\"value\", (dataSnapShot) => {\r\n      baseHealth = dataSnapShot.val();\r\n    });\r\n  firebase\r\n    .database()\r\n    .ref(\"response/\" + userid + \"/avatarStatus\")\r\n    .once(\"value\", (dataSnapShot) => {\r\n      baseStatus = dataSnapShot.val();\r\n    });\r\n  firebase\r\n    .database()\r\n    .ref(\"response/\" + userid + \"/currency\")\r\n    .once(\"value\", (dataSnapShot) => {\r\n      baseCurrency = dataSnapShot.val();\r\n    });\r\n  return baseHealth, baseStatus, baseCurrency;\r\n}\r\n\r\nfunction completeQuest(rewardHealth) {\r\n  baseHealth += rewardHealth[\"avatarHealth\"];\r\n  baseStatus += rewardHealth[\"avatarStatus\"];\r\n  baseCurrency += rewardHealth[\"shopCurrency\"];\r\n  if (baseHealth >= 100) {\r\n    fb.database()\r\n      .ref(\"response/\" + userid + \"/\")\r\n      .update({\r\n        avatarHealth: 100,\r\n        avatarStatus: baseStatus,\r\n        currency: baseCurrency,\r\n      })\r\n      .then(() => {\r\n        console.log(\"Completed a quest\");\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  } else {\r\n    fb.database()\r\n      .ref(\"response/\" + userid + \"/\")\r\n      .update({\r\n        avatarHealth: baseHealth,\r\n        avatarStatus: baseStatus,\r\n        currency: baseCurrency,\r\n      })\r\n      .then(() => {\r\n        console.log(\"Completed a quest\");\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  }\r\n}\r\n\r\n// Updating Quest after a quest has been completed.\r\nconst updating = (id, progress) => {\r\n  return new Promise(function (resolve, reject) {\r\n    let key;\r\n    if (id != null) {\r\n      key = id;\r\n    } else {\r\n      key = fb.database().ref().push().key;\r\n    }\r\n    let complete = {\r\n      questCompletion: progress[\"questMaxValue\"],\r\n      questMaxValue: progress[\"questMaxValue\"],\r\n    };\r\n    let dataToSave = {\r\n      questID: key,\r\n      questProgress: complete,\r\n    };\r\n    console.log(dataToSave);\r\n    fb.database()\r\n      .ref(\"/response/\" + userid + \"/quests/\" + key)\r\n      .update(dataToSave)\r\n      .then((snapshot) => {\r\n        resolve(snapshot);\r\n      })\r\n      .catch((err) => {\r\n        reject(err);\r\n      });\r\n  });\r\n};\r\n\r\nfunction ReadAllTab() {\r\n  const [quests, allQuests] = useState([]);\r\n  useEffect(() => {\r\n    const questRef = firebase\r\n      .database()\r\n      .ref(\"/response/\" + userid + \"/quests/\");\r\n    const OnLoadingListener = questRef.on(\"value\", (snapshot) => {\r\n      allQuests([]);\r\n      snapshot.forEach(function (childSnapshot) {\r\n        allQuests((quests) => [...quests, childSnapshot.val()]);\r\n      });\r\n    });\r\n    return () => {\r\n      questRef.off(\"value\", OnLoadingListener);\r\n    };\r\n  }, []);\r\n  return (\r\n    <View>\r\n      {quests.map(function (item) {\r\n        return (\r\n          <TouchableOpacity\r\n            key={item[\"questID\"]}\r\n            style={styles.textContainer}\r\n            onPress={() =>\r\n              Alert.alert(\r\n                \"Task Complete?\",\r\n                \"Confirm and get rewards:  \\nHealth: \" +\r\n                  item[\"questReward\"][\"avatarHealth\"] +\r\n                  \"\\nHappiness: \" +\r\n                  item[\"questReward\"][\"avatarStatus\"],\r\n                [\r\n                  {\r\n                    text: \"Cancel\",\r\n                    onPress: () => console.log(\"click cancel\"),\r\n                    style: \"cancel\",\r\n                  },\r\n                  {\r\n                    text: \"OK\",\r\n                    onPress: () => completeQuest(item[\"questReward\"]),\r\n                  },\r\n                ],\r\n                { cancelable: false }\r\n              )\r\n            }\r\n          >\r\n            <View style={styles.taskDiv}>\r\n              <Text style={styles.taskTitle}> {item[\"questName\"]}</Text>\r\n              <Text style={styles.rewardPoint}>\r\n                + {item[\"questReward\"][\"avatarHealth\"]}\r\n                <Icon name={\"md-heart\"} color={\"red\"} size={20} />\r\n              </Text>\r\n            </View>\r\n            <Text> {item[\"questDescription\"]}</Text>\r\n          </TouchableOpacity>\r\n        );\r\n      })}\r\n    </View>\r\n  );\r\n}\r\nReadAllTab.navigationOptions = {\r\n  tabBarIcon: ({ tintColor, focused }) => (\r\n    <Icon name={focused ? \"ios-cube\" : \"md-cube\"} color={tintColor} size={25} />\r\n  ),\r\n};\r\n\r\nfunction InProgreeTab() {\r\n  const [inProgress, allInProgressQuests] = useState([]);\r\n  useEffect(() => {\r\n    const questRef = firebase\r\n      .database()\r\n      .ref(\"/response/\" + userid + \"/quests/\");\r\n    const OnLoadingListener = questRef.on(\"value\", (snapshot) => {\r\n      allInProgressQuests([]);\r\n      snapshot.forEach(function (childSnapshot) {\r\n        allInProgressQuests((inProgress) => [\r\n          ...inProgress,\r\n          childSnapshot.val(),\r\n        ]);\r\n        // }\r\n      });\r\n    });\r\n    return () => {\r\n      questRef.off(\"value\", OnLoadingListener);\r\n    };\r\n  }, []);\r\n  return (\r\n    <View>\r\n      {inProgress.map(function (item) {\r\n        if (\r\n          item[\"questProgress\"][\"questCompletion\"] >= 0 &&\r\n          item[\"questProgress\"][\"questCompletion\"] !=\r\n            item[\"questProgress\"][\"questMaxValue\"]\r\n        ) {\r\n          return (\r\n            <TouchableOpacity\r\n              key={item[\"questID\"]}\r\n              style={styles.textContainer}\r\n              onPress={() =>\r\n                Alert.alert(\r\n                  \"Your Progress\",\r\n                  \"You have finished \" +\r\n                    item[\"questReward\"][\"avatarHealth\"] +\r\n                    \"/\" +\r\n                    item[\"questReward\"][\"avatarStatus\"] +\r\n                    \" of the task, good job and go on\",\r\n                  [\r\n                    {\r\n                      text: \"Cancel\",\r\n                      onPress: () => console.log(\"click cancel\"),\r\n                      style: \"cancel\",\r\n                    },\r\n                    {\r\n                      text: \"OK\",\r\n                      onPress: () => {\r\n                        completeQuest(item[\"questReward\"]);\r\n                        updating(item[\"questID\"], item[\"questProgress\"]);\r\n                      },\r\n                    },\r\n                  ],\r\n                  { cancelable: false }\r\n                )\r\n              }\r\n            >\r\n              <View style={styles.taskDiv}>\r\n                <Text style={styles.taskTitle}> {item[\"questName\"]}</Text>\r\n                <Text style={styles.rewardPoint}>\r\n                  + {item[\"questReward\"][\"avatarHealth\"]}\r\n                  <Icon name={\"md-heart\"} color={\"red\"} size={20} />\r\n                </Text>\r\n              </View>\r\n              <Text> {item[\"questDescription\"]}</Text>\r\n            </TouchableOpacity>\r\n          );\r\n        }\r\n      })}\r\n    </View>\r\n  );\r\n}\r\nInProgreeTab.navigationOptions = {\r\n  tabBarIcon: ({ tintColor, focused }) => (\r\n    <Icon\r\n      name={focused ? \"ios-stats\" : \"ios-stats\"}\r\n      color={tintColor}\r\n      size={25}\r\n    />\r\n  ),\r\n};\r\n\r\nfunction CompletionTab() {\r\n  const [completedQuest, allCompletedQuests] = useState([]);\r\n  useEffect(() => {\r\n    const questRef = firebase\r\n      .database()\r\n      .ref(\"/response/\" + userid + \"/quests/\");\r\n    const OnLoadingListener = questRef.on(\"value\", (snapshot) => {\r\n      allCompletedQuests([]);\r\n      snapshot.forEach(function (childSnapshot) {\r\n        allCompletedQuests((completedQuest) => [\r\n          ...completedQuest,\r\n          childSnapshot.val(),\r\n        ]);\r\n        // }\r\n      });\r\n    });\r\n    return () => {\r\n      questRef.off(\"value\", OnLoadingListener);\r\n    };\r\n  }, []);\r\n  return (\r\n    <View>\r\n      {completedQuest.map(function (item) {\r\n        if (\r\n          item[\"questProgress\"][\"questCompletion\"] ==\r\n          item[\"questProgress\"][\"questMaxValue\"]\r\n        ) {\r\n          {\r\n            return (\r\n              <TouchableOpacity\r\n                key={item[\"questID\"]}\r\n                style={styles.textContainer}\r\n              >\r\n                <View style={styles.taskDiv}>\r\n                  <Text style={styles.taskTitle}> {item[\"questName\"]}</Text>\r\n                  <Text style={styles.rewardPoint}>\r\n                    + {item[\"questReward\"][\"avatarHealth\"]}\r\n                    <Icon name={\"md-checkmark\"} color={\"green\"} size={20} />\r\n                  </Text>\r\n                </View>\r\n                <Text> {item[\"questDescription\"]}</Text>\r\n              </TouchableOpacity>\r\n            );\r\n          }\r\n        }\r\n      })}\r\n    </View>\r\n  );\r\n}\r\nCompletionTab.navigationOptions = {\r\n  tabBarIcon: ({ tintColor, focused }) => (\r\n    <Icon\r\n      name={focused ? \"ios-flag\" : \"ios-flag\"}\r\n      color={tintColor}\r\n      size={25}\r\n    />\r\n  ),\r\n};\r\n\r\nconst Tab = createMaterialTopTabNavigator(\r\n  {\r\n    All: ReadAllTab,\r\n    Inprogress: InProgreeTab,\r\n    Completed: CompletionTab,\r\n  },\r\n  {\r\n    tabBarOptions: {\r\n      activeTintColor: \"black\",\r\n      showIcon: true,\r\n      showLabel: true,\r\n      style: {\r\n        borderColor: \"black\",\r\n        backgroundColor: \"transparent\",\r\n      },\r\n    },\r\n  }\r\n);\r\nconst AppIndex = createAppContainer(Tab);\r\n\r\nexport default class QuestScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      questCompletion: 0,\r\n      avatarStatus: 0,\r\n      avatarHealth: 0,\r\n      baseCurrency: 0,\r\n      backgroundColor: 5,\r\n    };\r\n    if (!firebase.apps.length) {\r\n      firebase.initializeApp(ApiKeys.FirebaseConfig);\r\n    }\r\n    readData();\r\n    this.readData();\r\n  }\r\n\r\n  readData() {\r\n    userid = Fire.shared.user._id;\r\n    fb.database()\r\n      .ref(\"response/\" + userid + \"/backgroundColor\")\r\n      .once(\"value\", (dataSnapShot) => {\r\n        var tempColor = dataSnapShot.val();\r\n        this.setState({ backgroundColor: tempColor });\r\n      });\r\n    fb.database()\r\n      .ref(\"response/\" + userid + \"/currency\")\r\n      .once(\"value\", (dataSnapShot) => {\r\n        var temp = dataSnapShot.val();\r\n        this.setState({ baseCurrency: temp });\r\n      });\r\n  }\r\n\r\n  componentDidMount() {\r\n    baseHealth, baseStatus, baseCurrency = readData();\r\n    this.setState({\r\n      baseHealth: baseHealth,\r\n      baseStatus: baseStatus,\r\n      baseCurrency: baseCurrency,\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const background = getBackgroundImage(this.state.backgroundColor);\r\n    return (\r\n      <View style={styles.MainContainer}>\r\n        <ImageBackground source={background} style={styles.backgroundImage}>\r\n          <Header\r\n            props={this.props}\r\n            pageName=\"Quests\"\r\n          />\r\n          <AppIndex />\r\n        </ImageBackground>\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  backgroundImage: {\r\n    flex: 1,\r\n    resizeMode: \"cover\",\r\n    justifyContent: \"center\",\r\n  },\r\n  MainContainer: {\r\n    flex: 1,\r\n    flexDirection: \"column\",\r\n  },\r\n\r\n  navBar: {\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-evenly\",\r\n  },\r\n\r\n  taskCard: {\r\n    flex: 5,\r\n    backgroundColor: \"#fff\",\r\n    borderColor: \"black\",\r\n    borderWidth: 1,\r\n    margin: 10,\r\n    justifyContent: \"center\",\r\n  },\r\n\r\n  taskDiv: {\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n  },\r\n\r\n  taskTitle: {\r\n    fontSize: 20,\r\n  },\r\n\r\n  rewardPoint: {\r\n    fontSize: 20,\r\n    color: \"darkblue\",\r\n  },\r\n\r\n  taskbody: {\r\n    flex: 1,\r\n    fontSize: 14,\r\n  },\r\n\r\n  taskDone: {\r\n    borderColor: \"#737373\",\r\n    backgroundColor: \"darkgrey\",\r\n  },\r\n\r\n  Content: {\r\n    flex: 10,\r\n    backgroundColor: \"#fff\",\r\n    marginTop: \"15%\",\r\n  },\r\n\r\n  textContainer: {\r\n    padding: 10,\r\n    marginTop: 3,\r\n    backgroundColor: \"white\",\r\n    borderColor: \"darkgrey\",\r\n    borderWidth: 1,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}